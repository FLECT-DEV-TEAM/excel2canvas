(function(e){var i=1,q=2,o=3,l=4,b=5,n=6,d=7,m=8,p=9,f=10,r=11,j=12,h=13,c;function a(){return e.fn.tooltip&&e.fn.tooltip.defaults}function g(w,x){var s=x.back,t=x.fore,v=x.pattern;if(x.styleRef){var u=w.styles[x.styleRef].split("|");s=u[0];t=u[1];v=u[2]}if(t){c.fillStyle=t;c.fillRect(x.p[0],x.p[1],x.p[2],x.p[3])}}function k(C){var z=C.kind?C.kind:1,D=1,I=C.p[0],u=C.p[1],F=C.p[2],s=C.p[3],M=u==s;if(z==q||z==m||z==f||z==j){D=2}else{if(z==b){D=3}}c.lineWidth=D;if(D==1||D==3){if(M){u=u==0?0.5:u-0.5;s=s==0?0.5:s-0.5}else{I=I==0?0.5:I-0.5;F=F==0?0.5:F-0.5}}else{if(M&&u==0){u=1;s=1}else{if(!M&&I==0){I=1;F=1}}}if(C.color){c.strokeStyle=C.color}else{c.strokeStyle="#000000"}if(z==n){c.beginPath();if(M){c.moveTo(I,u-1);c.lineTo(F,s-1);c.moveTo(I,u+1);c.lineTo(F,s+1)}else{c.moveTo(I-1,u);c.lineTo(F-1,s);c.moveTo(I+1,u);c.lineTo(F+1,s)}c.stroke();c.closePath()}else{if(z==o||z==l||z==d||z==m){var J,E;switch(z){case o:J=4;E=2;break;case l:J=2;E=2;break;case d:J=1;E=1;break;case m:J=8;E=3;break}var H=true;c.beginPath();c.moveTo(I,u);if(M){var A=u,v=I,K=F;while(v<K){var N=H?J:E;v+=N;if(v>K){v=K}if(H){c.lineTo(v,A)}else{c.moveTo(v,A)}H=!H}}else{var B=I,t=u,G=s;while(t<G){var L=H?J:E;t+=L;if(t>G){t=G}if(H){c.lineTo(B,t)}else{c.moveTo(B,t)}H=!H}}c.stroke();c.closePath()}else{c.beginPath();c.moveTo(I,u);c.lineTo(F,s);c.stroke();c.closePath()}}}e.fn.excelToCanvas=function(K,u){var A,v;if(this[0].tagName=="canvas"){v=this;A=v.parent()}else{A=this;v=A.find("canvas");if(v.length==0){v=e("<canvas style='position:absolute;left:0;top:0;z-index:0'></canavas>").appendTo(A)}}if(typeof FlashCanvas!=="undefined"){FlashCanvas.initElement(v[0])}v.attr("width",K.width).attr("height",K.height);c=v[0].getContext("2d");c.fillStyle="white";c.fillRect(0,0,K.width,K.height);if(K.fills){for(var I=0;I<K.fills.length;I++){var F=K.fills[I];g(K,F)}}if(K.lines){for(var I=0;I<K.lines.length;I++){var y=K.lines[I];k(y)}}if(K.strs){for(var I=0;I<K.strs.length;I++){var E=K.strs[I],J=E.style?E.style:K.styles[E.styleRef],H=e("<span style='"+J+"'></span>");if(E.link){var w=e("<a target='_blank'></a>");w.append(E.text);w.attr("href",E.link);H.append(w)}else{H.append(E.text)}var G=E.align;if(G){H.addClass("cell-a"+G[0]);H.addClass("cell-v"+G[1]);if(G[1]=="c"||G[1]=="j"){var D=E.text.split("<br>").length;if(D>1){H.css("margin-top","-"+(D/2)+"em")}}}if(E.rawdata){H.attr("data-raw",E.rawdata)}var z=e("<div id='"+E.id+"' class='cell'></div>").append(H);z.css({left:E.p[0],top:E.p[1],width:E.p[2],height:E.p[3]});if(E.clazz){z.addClass(E.clazz)}if(E.comment&&a()){c.strokeStyle="red";c.fillStyle="red";c.beginPath();c.moveTo(E.p[0]+E.commentWidth-4,E.p[1]);c.lineTo(E.p[0]+E.commentWidth,E.p[1]);c.lineTo(E.p[0]+E.commentWidth,E.p[1]+4);c.lineTo(E.p[0]+E.commentWidth-4,E.p[1]);c.stroke();c.fill();c.closePath();z.tooltip({title:E.comment})}A.append(z)}}if(K.pictures){for(var I=0;I<K.pictures.length;I++){var C=K.pictures[I],M=e("<img class='excel-img'/>");M.attr("src",C.uri);M.css({left:C.p[0],top:C.p[1],width:C.p[2],height:C.p[3]});A.append(M)}}if(K.charts&&e.fn.excelToChart){for(var I=0;I<K.charts.length;I++){var B=K.charts[I],s=e("<div class='excel-chart'></div>");s.css({left:B.p[0],top:B.p[1],width:B.p[2],height:B.p[3]});A.append(s);s.excelToChart(B.chart);s.css("position","absolute")}}if(u){for(var L in u){var z=e("#"+L);if(z.length>0){var x=u[L];if(typeof(x)==="string"){z.find("span").text(x)}else{if(x.element){var t=e(document.createElement(x.element));for(attr in x){if(attr!="element"){t.attr(attr,x[attr])}}z.css("overflow","visible").empty().append(t)}}}}}return this}})(jQuery);